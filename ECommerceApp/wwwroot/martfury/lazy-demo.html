<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Lazy Loading Demo</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            line-height: 1.6;
        }
        
        .stats {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
        }
        
        .demo { 
            margin: 50px 0; 
            text-align: center; 
        }
        
        img { 
            width: 300px; 
            height: 200px; 
            object-fit: cover; 
            margin: 10px; 
            border-radius: 8px;
            transition: opacity 0.3s ease;
        }
        
        .spacer { 
            height: 150vh; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 18px; 
            color: #666; 
            border: 2px dashed #ddd;
            margin: 20px 0;
        }
        
        .bg-demo {
            width: 100%; 
            height: 300px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-size: 24px; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            border-radius: 8px;
            background-color: #f0f0f0;
        }

        /* Show loading state */
        img[data-src]:not(.lazy-loaded) {
            background: #f0f0f0;
            opacity: 0.7;
        }

        img.lazy-loaded {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="stats" id="stats">
        Loading stats...
    </div>

    <h1>üñºÔ∏è Smart Lazy Loading Demo</h1>
    <p><strong>Instructions:</strong></p>
    <ul>
        <li>Open browser dev tools (F12)</li>
        <li>Go to Network tab ‚Üí Throttle to "Slow 3G"</li>
        <li>Scroll down slowly to see lazy loading in action</li>
        <li>Watch images blur-to-sharp transition</li>
        <li>Check console for loading events</li>
    </ul>
    
    <div class="demo">
        <h3>First set (load immediately)</h3>
        <img data-src="https://picsum.photos/300/200?random=1" alt="Demo image 1" loading="lazy">
        <img data-src="https://picsum.photos/300/200?random=2" alt="Demo image 2" loading="lazy">
    </div>
    
    <div class="spacer">üìç Scroll down to trigger lazy loading...</div>
    
    <div class="demo">
        <h3>Second set (lazy loaded)</h3>
        <img data-src="https://picsum.photos/300/200?random=3" alt="Demo image 3" loading="lazy">
        <img data-src="https://picsum.photos/300/200?random=4" alt="Demo image 4" loading="lazy">
        <img data-src="https://picsum.photos/300/200?random=5" alt="Demo image 5" loading="lazy">
    </div>
    
    <div class="spacer">üìç Keep scrolling for background image...</div>
    
    <div class="demo">
        <h3>Background image (lazy loaded)</h3>
        <div class="bg-demo" data-background="https://picsum.photos/600/300?random=6">
            Background Image Loaded
        </div>
    </div>
    
    <div class="spacer">üìç More images below...</div>
    
    <div class="demo">
        <h3>Final set</h3>
        <img data-src="https://picsum.photos/300/200?random=7" alt="Demo image 7" loading="lazy">
        <img data-src="https://picsum.photos/300/200?random=8" alt="Demo image 8" loading="lazy">
        <img data-src="https://picsum.photos/300/200?random=9" alt="Demo image 9" loading="lazy">
    </div>

    <div style="margin: 50px 0; padding: 20px; background: #f8f9fa; border-radius: 8px;">
        <h3>üí° How to implement in your pages:</h3>
        <p><strong>1. Include the JavaScript:</strong></p>
        <pre style="background: #e9ecef; padding: 10px; border-radius: 4px;"><code>&lt;script src="js/smart-lazy-loading.js" defer&gt;&lt;/script&gt;</code></pre>
        
        <p><strong>2. Convert your images:</strong></p>
        <pre style="background: #e9ecef; padding: 10px; border-radius: 4px;"><code>From: &lt;img src="image.jpg" alt="Description"&gt;
To:   &lt;img data-src="image.jpg" alt="Description" loading="lazy"&gt;</code></pre>
        
        <p><strong>3. For background images:</strong></p>
        <pre style="background: #e9ecef; padding: 10px; border-radius: 4px;"><code>&lt;div data-background="background.jpg"&gt;Content&lt;/div&gt;</code></pre>
    </div>

    <!-- Include the smart lazy loading script -->
    <script src="js/smart-lazy-loading.js"></script>
    <script>
        // Update stats display
        function updateStats() {
            if (window.lazyLoader) {
                const stats = window.lazyLoader.getStats();
                document.getElementById('stats').innerHTML = `
                    <strong>üìä Lazy Loading Stats</strong><br>
                    Total Images: ${stats.totalImages}<br>
                    Loaded: ${stats.loadedImages}<br>
                    Pending: ${stats.pendingImages}<br>
                    Progress: ${stats.loadedPercentage}%
                `;
            } else {
                document.getElementById('stats').innerHTML = 'Loading lazy loader...';
            }
        }

        // Update every second
        setInterval(updateStats, 1000);

        // Listen for events
        document.addEventListener('lazyLoaded', (e) => {
            console.log('‚úÖ Image loaded:', e.detail.imageData.originalSrc);
        });

        document.addEventListener('lazyError', (e) => {
            console.error('‚ùå Image failed:', e.detail.imageData.originalSrc);
        });

        // Manual trigger
        window.addEventListener('keydown', (e) => {
            if (e.key === 'l' && e.ctrlKey) {
                console.log('üöÄ Loading all remaining images...');
                window.lazyLoader?.loadAll();
            }
        });

        console.log('üìñ Demo Instructions:');
        console.log('1. Throttle network to see effect');
        console.log('2. Scroll to trigger lazy loading');
        console.log('3. Press Ctrl+L to load all images');
    </script>
</body>
</html>
